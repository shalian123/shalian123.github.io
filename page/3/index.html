<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Wind" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="记录生活点滴">
<meta property="og:type" content="website">
<meta property="og:title" content="Wind">
<meta property="og:url" content="http://shalian123.github.io/page/3/index.html">
<meta property="og:site_name" content="Wind">
<meta property="og:description" content="记录生活点滴">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wind">
<meta name="twitter:description" content="记录生活点滴">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Wind </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Wind</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">细节在于观察，成功在于积累。</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/27/简述如何将qt程序在arm开发板上运行起来/" itemprop="url">
                  简述如何将qt程序在arm开发板上运行起来
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-27T19:01:38+08:00" content="2017-06-27">
              2017-06-27
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/嵌入式/" itemprop="url" rel="index">
                    <span itemprop="name">嵌入式</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/27/简述如何将qt程序在arm开发板上运行起来/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/27/简述如何将qt程序在arm开发板上运行起来/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前我谈论了qt的一些开发应用，他主要应用在一些嵌入式设备上，比如平板，机顶盒，路由等等。下面我简要通过我的试验和学习过程总结出：将qt程序移植到开发板（平板）上。（）</p>
<h4 id="Qt-E4-7-1-编译器的安装"><a href="#Qt-E4-7-1-编译器的安装" class="headerlink" title="Qt/E4.7.1 编译器的安装"></a>Qt/E4.7.1 编译器的安装</h4><p>Qt/E4.7.1 使用的编译器是交叉编译器编译工具“arm-linux-gcc-4.3.2.tar.gz”<br>1.将“arm-linux-gcc-4.3.2.tar.gz”解压到 Ubuntu 系统的文件夹“/usr/local/arm”中<br>2.修改环境变量（注意：root用户下）<br>  输入命令“<code>vim .bashrc</code>”，打开设置环境变量的文件“.bashrc”，然后进入最后行，如下图，将环境变量修改为<br>  “<code>export PATH=$PATH:/usr/local/arm/4.3.2/bin</code>”，如下图：<img src="http://ols4zt49w.bkt.clouddn.com/1498563723%281%29.png" alt=""><br>  保存退出，然后更新一下环境变量，输入命令“<code>source .bashrc</code>”<br> 接着测试一下，编译器路径设置的对不对。如下图，在 Ubuntu 命令行中输入命令”arm”,然后按键盘”Tab”，出现编译器“arm-none-linux-gnueabi-gcc-4.3.2”，这就说明编译器路径设置正确。 如下图：<br> <img src="http://ols4zt49w.bkt.clouddn.com/1498564244%281%29.png" alt=""></p>
<h4 id="Qt-E4-7-1-镜像的编译"><a href="#Qt-E4-7-1-镜像的编译" class="headerlink" title="Qt/E4.7.1 镜像的编译"></a>Qt/E4.7.1 镜像的编译</h4><p>先将 Qt/E4.7.1 源码压缩包“qt-everywhere-opensource-src-4.7.1.tar.gz”拷贝到 Ubuntu 的文件夹“root/yizhi”中，没有这个文件夹则可以新建一个。在 Ubuntu 命令行中输入解压命令“<code>tar -vxf qt-everywhere-opensource-src-4.7.1.tar.gz</code>”，解压后得到文件夹“qt-everywhere-opensource-src-4.7.1”。<br>进入“qt-everywhere-opensource-src-4.7.1”文件夹中，执行编译脚本“<code>./build-all</code>”,注意这个命令有个点“<code>.</code>”如下图：<br><img src="http://ols4zt49w.bkt.clouddn.com/1498564694%281%29.png" alt=""><br>输入回车，如下图所示，开始编译，编译比较耗费时间。<br>编译完成后，如下图，进入”/opt”目录，可以看到编译生成的“qt-4.7.1”文件夹。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498564714%281%29.png" alt=""><br>进入文件夹“/home/topeet/Linux+QT/root/opt”（目录 topeet 根据用户实际建立的文件夹调整），然后将“qt-4.7.1”文件夹拷贝到该目录下，如下图。红色框中的“qt-4.7.1”文件夹是 Qt/E4.7，蓝色框中的”Qtopia”就是之前编译得到的“Qtopia”文件系统。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498564966%281%29.png" alt=""><br>如下图，进入文件夹“/home/topeet/Linux+QT”中，输入命令“<code>make_ext4fs -s -l 314572800 -a root -L linux system.img root</code>”，编译生成二进制文件“system.img”。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498565228.png" alt=""><br>如下图，文件“system.img”就是 Qt/E4.7 的镜像。（注意：编译生成Qt/E4.7 的镜像的时候，文件夹“/home/topeet/Linux+QT/root/opt里不要有qtopia文件系统）<br><img src="http://ols4zt49w.bkt.clouddn.com/1498565428%281%29.png" alt=""><br>其它三个文件和 Qtopia 文件系统对应的镜像一模一样。</p>
<p>  <strong>补充：</strong><br> <strong>生成 system.img的前期工作：</strong><br> 生成可以下载的 system.img 文件需要工具“mkimage，这里在客服提供的02_编译器以及烧写工具”→“tools”文件夹下的压缩包“linux_tools.tgz”中。<br>拷贝压缩包到 Ubuntu 系统的“/”目录下，<strong>注意目录是“/”</strong>。<br>进入“/”目录，然后使用命令“<code>tar -vxf linux_tools.tgz</code> ”，将压缩包解压。<br>解压后如下图所示，在“/usr/local/bin/”目录下生成了两个文件。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498566182%281%29.png" alt=""><br>使用命令“<code>cd /home/topeet/</code>”进入 topeet 目录，然后使用命令“<code>mkdir Linux+QT</code>”新建一个“Linux+QT”文件夹。如下图所示：<br><img src="http://ols4zt49w.bkt.clouddn.com/1498566369%281%29.png" alt=""><br>拷贝root.tar.gz”到新建的“Linux+QT”文件夹，如下图<br><img src="http://ols4zt49w.bkt.clouddn.com/1498566645%281%29.png" alt=""><br>使用命令“<code>tar -vxf root_20150123.tar.gz</code>”解压压缩包<br>解压后会生成文件夹“root”，如下图所示。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498566756%281%29.png" alt=""><br><strong>在编译生成镜像前先把前面编译生成的文件夹“Qtopia”或qt-4.7.1”文件夹拷贝到root解压出来的“opt”文件夹中</strong>，在执行上面的操作后，最后执行生成二进制文件的命令，在目录“/home/topeet/Linux+QT ”中，使用命令“<code>make_ext4fs -s -l 314572800 -a root -L linux system.img root</code>”</p>
<p><strong>以上为生成system.img的前期工作或者必须了解的。</strong></p>
<h4 id="系统运行后-Qt-E4-7-和-Qtopia2-2-0-的切换"><a href="#系统运行后-Qt-E4-7-和-Qtopia2-2-0-的切换" class="headerlink" title="系统运行后 Qt/E4.7 和 Qtopia2.2.0 的切换"></a>系统运行后 Qt/E4.7 和 Qtopia2.2.0 的切换</h4><p>为了方便切换，只需要将编译 Qtopia 和编译 Qt/E4.7 得到的文件夹同时放到“/home/topeet/Linux+QT/root/opt”目录中，然后再使用“<code>make_ext4fs -s -l 314572800 -a root -L linux system.img root</code>”，编译可以得到“system.img”。</p>
<h5 id="设置开发板优先运行的文件系统"><a href="#设置开发板优先运行的文件系统" class="headerlink" title="设置开发板优先运行的文件系统"></a>设置开发板优先运行的文件系统</h5><p>源代码编译后，<strong>默认是运行 Qtopia</strong>，下面讲一下如何直接运行 Qt/E4.7。<br>这里需要修改“root/etc/init.d/rcS”文件。如下图所示，打开“root/etc/init.d/rcS”文件<br><img src="http://ols4zt49w.bkt.clouddn.com/1498565767%281%29.png" alt=""><br>打开文件“rcS”后，进入文件中的最后一行，如果要默认启动“qt-4.7.1”，则将修改为上图中的“qtopia”修改为“qt4”，如下图<br>所示。注意这里的修改语法和格式一定要和源代码的的一样。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498567183%281%29.png" alt=""><br>修改后，<strong>重新编译生成二进制文件</strong>，系统就会默认运行 Qt/E4.7。</p>
<p><strong>注意：</strong>Qt/E4.7.1 的u-boot-iTOP-4412.bin、zImage 以及ramdisk-uboot.img 和Qtopia 通用，编译方法也一样。它们的区别是“Qtopia”带有一个桌面系统，“Qt/E4.7.1”只是一个强大的库。关于他们的区别，可以参考我之前的一篇博客：<a href="http://shalian.site/2017/03/16/QT-Qte-Qtopia%E4%B8%89%E8%80%85%E7%9A%84%E5%8C%BA%E5%88%AB/" target="_blank" rel="external">QT/Qte/Qtopia三者的区别</a></p>
<h5 id="系统运行后-Qt-E4-7-和-Qtopia2-2-0-的切换-1"><a href="#系统运行后-Qt-E4-7-和-Qtopia2-2-0-的切换-1" class="headerlink" title="系统运行后 Qt/E4.7 和 Qtopia2.2.0 的切换"></a>系统运行后 Qt/E4.7 和 Qtopia2.2.0 的切换</h5><p>输入切换命令的时候如果已经打开过一个文件系统，则需要先关闭已启动文件系统的进程。下面举例说明，如何关闭文件系统的进程。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498567538%281%29.png" alt=""><br><img src="http://ols4zt49w.bkt.clouddn.com/1498567561%281%29.png" alt=""><br>Qt/E4.7 文件系统启动后，再切换到 Qtopia2.2.0，也是使用和上面类似的方法，这里就不再重复讲解了。</p>
<h4 id="在-iTOP-4412-开发板上运行-helloworld"><a href="#在-iTOP-4412-开发板上运行-helloworld" class="headerlink" title="在 iTOP-4412 开发板上运行 helloworld"></a>在 iTOP-4412 开发板上运行 helloworld</h4><p>在ubuntu里进入源码文件夹<br><img src="http://ols4zt49w.bkt.clouddn.com/1498567854%281%29.png" alt=""><br>之前我们编译生成了“/opt/qt-4.7.1/”，这个文件夹包含了移植所需要的<strong>最重要的工具 qmake。</strong>进入“<strong>/opt/qt-4.7.1/bin</strong>”，可以看到 qmake 文件。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498567953%281%29.png" alt=""><br>查看了 Qt/E4.7.1 的 qmake 之后，再进入 helloworld 的源码文件夹，然后，在该文件夹中运行 qmake “<code>#/opt/qt-4.7.1/bin/qmake</code>”<br><img src="http://ols4zt49w.bkt.clouddn.com/1498568160%281%29.png" alt=""><br>如下图，多了一个 Makefile 文件。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498568168%281%29.png" alt=""><br>然后，执行编译命令“#make”，如下图所示。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498568292%281%29.png" alt=""><br>生成了“helloworld”<br><img src="http://ols4zt49w.bkt.clouddn.com/1498568375%281%29.png" alt=""><br>然后，我们使用 file 命令测试一下。如下图，“#file helloworld”，可以看到 hellworld应用文件的基本信息，它是属于 ARM 平台的。<br><img src="http://ols4zt49w.bkt.clouddn.com/1498568440%281%29.png" alt=""><br>最后，将此文件U盘或tf卡挂载。在超级终端中，先修改权限“#<code>chmod 777 helloworld</code>”，然后再运行“#<code>./hellworld -qws</code>”<br>结果如下：<br><img src="http://ols4zt49w.bkt.clouddn.com/468431670471850727.jpg" alt=""></p>
<h4 id="linux-Qt系统下挂载U盘"><a href="#linux-Qt系统下挂载U盘" class="headerlink" title="linux Qt系统下挂载U盘"></a>linux Qt系统下挂载U盘</h4><p><img src="http://ols4zt49w.bkt.clouddn.com/1498568714%281%29.png" alt=""></p>
<p>最后，欢迎志同道合者一起交流~</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/14/商品促销-策略模式-c-实现/" itemprop="url">
                  商品促销-策略模式(c++实现)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-14T19:36:07+08:00" content="2017-06-14">
              2017-06-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大话设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">大话设计模式</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/14/商品促销-策略模式-c-实现/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/14/商品促销-策略模式-c-实现/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>策略模式是一种定义一系列算法的方法，从概念上来看，所有这些算法完成的都是相同的工作，只是实现不同，它(策略模式)可以以相同的方式调用所有的算法，<strong>减少</strong>了各种算法类与使用算法类的之间的<strong>耦合</strong>。<br>策略模式就是用来封装算法的，但在实践中，可以用它来封装几乎任何类型的规则，只要在分析过程中听到需要在不同的时间应用不同的业务规则，就可以考虑使用策略模式处理这种变化的可能性。<br><img src="http://ols4zt49w.bkt.clouddn.com/1497440990%281%29.png" alt=""><br>补充：UML类图：</p>
<p>类图一般分三层，第一层显示类的名称，如果是抽象类，则用斜体表示。第二层是类的特性，通常是字段和属性。第三层是类的操作，通常是方法或行为。<br>注意前面的符号，‘+’表示public，‘-’表示private，‘#’表示protected。<br><strong>继承</strong>用空心箭头+实线表示<br><strong>实现接口</strong>用空心箭头+虚线表示<br><strong>关联</strong>关系用实线箭头表示<br><strong>聚合</strong>表示一种弱的‘拥有’关系，体现的是A对象可以包含B对象，但B对象不是A对象的一部分，聚合用空心的菱形+实线箭头表示。<br><strong>合成</strong>（组合）是一种强的‘拥有’关系，体现了严格的部分和整体的关系。合成关系用实心的菱形+实线箭头表示。<br><strong>依赖</strong>关系，用虚线箭头表示。</p>
<p>以商场促销活动为例，可以有多种促销方式，如打折、返现、积分等。这些活动都对应着不同的算法，也就是不同的策略来计算应付的金额。如果不对这些策略进行封装，每次活动的改变都要修改程序中的很多地方，不够灵活，可维护性差。将所有的策略封装成相互独立的类，由一个统一的抽象类Strategy类指明具体用到的策略类。还需要一个上下文策略类来配置这些策略即Context类。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div></pre></td><td class="code"><pre><div class="line">#include &lt;iostream&gt;</div><div class="line">using namespace std;</div><div class="line"></div><div class="line">/*付款金额计算的抽象类*/</div><div class="line">class CashSuper</div><div class="line">&#123;</div><div class="line">public:</div><div class="line">	/*计算应付金额*/</div><div class="line">	virtual double AcceptCash(double money) = 0;//纯虚函数</div><div class="line">&#125;;</div><div class="line"></div><div class="line">/*正常收费策略*/</div><div class="line">class CashNormal : public CashSuper</div><div class="line">&#123;</div><div class="line">public:</div><div class="line">	virtual double AcceptCash(double money)</div><div class="line">	&#123;</div><div class="line">		return money;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">/*打折收费策略*/</div><div class="line">class CashRebate : public CashSuper</div><div class="line">&#123;</div><div class="line">private:</div><div class="line">	double discount;</div><div class="line">public:</div><div class="line">	//构造函数</div><div class="line">	CashRebate(double dis) : discount(dis)//构造函数初始化列表以一个冒号开始，接着是以逗号分隔的数据成员列表，每个数据成员后面跟一个放在括号中的初始化式。(显性初始化类成员)</div><div class="line">	&#123;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	virtual double AcceptCash(double money)</div><div class="line">	&#123;</div><div class="line">		return money * discount;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">/*返现收费策略*/</div><div class="line">class CashReturn : public CashSuper</div><div class="line">&#123;</div><div class="line">private:</div><div class="line">	double moneyCondition;</div><div class="line">	double moneyReturn;</div><div class="line">public:</div><div class="line">	CashReturn(double condition, double retu) : moneyCondition(condition), moneyReturn(retu)</div><div class="line">	&#123;&#125;</div><div class="line"></div><div class="line"></div><div class="line">	virtual double AcceptCash(double money)</div><div class="line">	&#123;</div><div class="line">		double result = money;</div><div class="line"></div><div class="line">		if (money &gt; moneyCondition)</div><div class="line">		&#123;</div><div class="line">			result = money - (static_cast&lt;int&gt;(money / moneyCondition)) * moneyReturn;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		return result;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">/* 收费策略 */</div><div class="line">class CashContext</div><div class="line">&#123;</div><div class="line">private:</div><div class="line">	CashSuper* cs; /* 声明付款金额的收费策略 */</div><div class="line"></div><div class="line">public:</div><div class="line">	/*初始化时，传入具体的策略对象(正常、打折、返现)*/</div><div class="line">	CashContext(int type)</div><div class="line">	&#123;</div><div class="line">		switch (type)</div><div class="line">		&#123;</div><div class="line">		case 1:</div><div class="line">			cs = new CashNormal();</div><div class="line">			break;</div><div class="line">		case 2:</div><div class="line">			cs = new CashRebate(0.8);</div><div class="line">			break;</div><div class="line">		case 3:</div><div class="line">			cs = new CashReturn(300, 100);</div><div class="line">			break;</div><div class="line">		default:</div><div class="line">			throw exception(&quot;没有这种促销活动&quot;);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	~CashContext()</div><div class="line">	&#123;</div><div class="line">		delete cs;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	/*得到现金计算结果(利用了多态机制，不同的策略行为导致不同的结果)*/</div><div class="line">	double GetResult(double money)</div><div class="line">	&#123;</div><div class="line">		return cs-&gt;AcceptCash(money);</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	double price;</div><div class="line">	double number;</div><div class="line">	int type;  /* 活动类型 */</div><div class="line"></div><div class="line">	cout &lt;&lt; &quot;请输入单价: &quot;;</div><div class="line">	cin &gt;&gt; price;</div><div class="line"></div><div class="line">	cout &lt;&lt; &quot;请输入数量: &quot;;</div><div class="line">	cin &gt;&gt; number;</div><div class="line"></div><div class="line">	cout &lt;&lt; &quot;请选择促销活动：&quot; &lt;&lt; endl</div><div class="line">		&lt;&lt; &quot;1 : 正常收费&quot; &lt;&lt; endl</div><div class="line">		&lt;&lt; &quot;2 : 打8折&quot; &lt;&lt; endl</div><div class="line">		&lt;&lt; &quot;3 : 满 300 返 100&quot; &lt;&lt; endl;</div><div class="line">	cin &gt;&gt; type;</div><div class="line"></div><div class="line">	try</div><div class="line">	&#123;</div><div class="line">		CashContext cashcontext(type);</div><div class="line"></div><div class="line">		cout &lt;&lt; &quot;总计：&quot; &lt;&lt; price * number &lt;&lt; endl;</div><div class="line"></div><div class="line">		cout &lt;&lt; &quot;实收现金：&quot;;</div><div class="line">		cout &lt;&lt; cashcontext.GetResult(price * number) &lt;&lt; endl;</div><div class="line">	&#125;</div><div class="line">	catch (exception&amp; e)</div><div class="line">	&#123;</div><div class="line">		cout &lt;&lt; e.what() &lt;&lt; endl;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果有新的促销活动需要加入，只需再写一个对应的策略类，并在CashContext类中修改部分代码即可实现。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/14/简单工厂模式-c-实现/" itemprop="url">
                  简单工厂模式(c++实现)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-14T19:20:45+08:00" content="2017-06-14">
              2017-06-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大话设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">大话设计模式</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/14/简单工厂模式-c-实现/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/14/简单工厂模式-c-实现/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>面向对象设计有封装、继承与多态三大特性。<br>多态的实现可以采用：虚函数，抽象类，模板等来实现。<br>用简单工厂模式设计一个计算器：<br>这里<strong>我采用的是虚函数的重载</strong>，也可以用抽象类来实现的：让计算数据和过程与显示结果分开体现了封装的特性；为了程序的可扩展性，比如以后要加入开根号的运算而不去重写整个类，<strong>可以将每个操作符单独作为一个类</strong>，他们都继承共同的父类——<strong>抽象类：Operation类</strong>，这里体现了<strong>继承</strong>和<strong>多态</strong>的特性。<br>如何让计算器知道该用哪个操作符的类呢，这里用到了“简单工厂模式”，也就是，<strong>到底要实例化哪个操作符类</strong>，应该考虑<strong>用一个单独的类来做这个创造实例的过程，这就是工厂。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;exception&gt;</div><div class="line">using namespace std;</div><div class="line"></div><div class="line">//Operation运算类  </div><div class="line">class Operation</div><div class="line">&#123;</div><div class="line">private:</div><div class="line">	double _numberA;</div><div class="line">	double _numberB;</div><div class="line"></div><div class="line">public:</div><div class="line">	Operation()&#123;&#125;//构造函数，可以不用自己定义</div><div class="line">	Operation(double numA, double numb) :_numberA(numA), _numberB(numb)</div><div class="line">	&#123;</div><div class="line">	&#125;</div><div class="line">	virtual double GetResult()</div><div class="line">	&#123;</div><div class="line">		double result = 0;</div><div class="line">		return result;</div><div class="line">	&#125;</div><div class="line">	void set_numberA(double numA)</div><div class="line">	&#123;</div><div class="line">		_numberA = numA;</div><div class="line">	&#125;</div><div class="line">	void set_numberB(double numB)</div><div class="line">	&#123;</div><div class="line">		_numberB = numB;</div><div class="line">	&#125;</div><div class="line">	double get_numberA()</div><div class="line">	&#123;</div><div class="line">		return _numberA;</div><div class="line">	&#125;</div><div class="line">	double get_numberB()</div><div class="line">	&#123;</div><div class="line">		return _numberB;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;;</div><div class="line"></div><div class="line">//加减乘除类  </div><div class="line">class OperationAdd :public Operation      //默认的是私有继承</div><div class="line">&#123;</div><div class="line">public:</div><div class="line">	OperationAdd()&#123;&#125;</div><div class="line">	OperationAdd(double numA, double numB) :Operation(numA, numB)&#123;&#125;</div><div class="line">	double GetResult()</div><div class="line">	&#123;</div><div class="line">		double result = 0;</div><div class="line">		result = get_numberA() + get_numberB();</div><div class="line">		return result;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;;</div><div class="line"></div><div class="line">class OperationSub :public Operation</div><div class="line">&#123;</div><div class="line">public:</div><div class="line">	OperationSub()&#123;&#125;</div><div class="line">	OperationSub(double numA, double numB) :Operation(numA, numB)&#123;&#125;</div><div class="line">	double GetResult()</div><div class="line">	&#123;</div><div class="line">		double result = 0;</div><div class="line">		result = get_numberA() - get_numberB();</div><div class="line">		return result;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">class OperationMul : public Operation</div><div class="line">&#123;</div><div class="line">public:</div><div class="line">	OperationMul()&#123;&#125;</div><div class="line">	OperationMul(double numA, double numB) :Operation(numA, numB)&#123;&#125;</div><div class="line">	double GetResult()</div><div class="line">	&#123;</div><div class="line">		double result = 0;</div><div class="line">		result = get_numberA() * get_numberB();</div><div class="line">		return result;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">class OperationDiv :public Operation</div><div class="line">&#123;</div><div class="line">public:</div><div class="line">	OperationDiv()&#123;&#125;</div><div class="line">	OperationDiv(double numA, double numB) :Operation(numA, numB)&#123;&#125;</div><div class="line">	double GetResult()</div><div class="line">	&#123;</div><div class="line">		double result = 0;</div><div class="line"></div><div class="line">		if (get_numberB() == 0)&#123;</div><div class="line">			throw new exception(&quot;除数不能为零&quot;);</div><div class="line">		&#125;</div><div class="line">		result = get_numberA() / get_numberB();</div><div class="line">		return result;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">//简单运算工厂类  </div><div class="line">class OperationFactory</div><div class="line">&#123;</div><div class="line">public:</div><div class="line">	Operation *createOperate(char operate)</div><div class="line">	&#123;</div><div class="line">		Operation *oper = NULL;</div><div class="line">		switch (operate)&#123;</div><div class="line">		case &apos;+&apos;:</div><div class="line">			oper = new OperationAdd();</div><div class="line">			break;</div><div class="line">		case &apos;-&apos;:</div><div class="line">			oper = new OperationSub();</div><div class="line">			break;</div><div class="line">		case &apos;*&apos;:</div><div class="line">			oper = new OperationMul();</div><div class="line">			break;</div><div class="line">		case &apos;/&apos;:</div><div class="line">			oper = new OperationDiv();</div><div class="line">			break;</div><div class="line">		&#125;</div><div class="line">		return oper;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	Operation *oper=NULL;</div><div class="line">	OperationFactory operFactory;</div><div class="line">	double numA, numB;</div><div class="line">	char operate;</div><div class="line">	cout &lt;&lt; &quot;请输入第一个数字&quot; &lt;&lt; endl;</div><div class="line">	cin &gt;&gt; numA;</div><div class="line">	cout &lt;&lt; &quot;请输入第二个数字&quot; &lt;&lt; endl;</div><div class="line">	cin &gt;&gt; numB;</div><div class="line">	cout &lt;&lt; &quot;请输入操作符&quot; &lt;&lt; endl;</div><div class="line">	cin &gt;&gt; operate;</div><div class="line">	oper = operFactory.createOperate(operate);</div><div class="line">	oper-&gt;set_numberA(numA);</div><div class="line">	oper-&gt;set_numberB(numB);</div><div class="line">	double result = oper-&gt;GetResult();</div><div class="line">	delete oper;</div><div class="line">	cout &lt;&lt; &quot;result=&quot; &lt;&lt; result &lt;&lt; endl;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/14/c-笔记之友元类和运算符重载/" itemprop="url">
                  c++笔记之友元类和运算符重载
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-14T18:59:00+08:00" content="2017-06-14">
              2017-06-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/c-c/" itemprop="url" rel="index">
                    <span itemprop="name">c/c++</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/14/c-笔记之友元类和运算符重载/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/14/c-笔记之友元类和运算符重载/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前在看设计模式时遇到了一些问题，一直没有时间来整理，现在终于研一课程全部结束了，因此回过头来整理一下。</p>
<p>1.friend ostream&amp; operator &lt;&lt;（ostream&amp; out，const Money&amp; x）是什么意思？<br>答：对”&lt;&lt;”运算符的重载。<br><strong>一般我们用的”&lt;&lt;”只能输出整型、实型等普通类型</strong>。<br>要<strong>想输出类的类型，则必须对”&lt;&lt;”进行重载</strong>，<strong>其中一个参数为类类型对象</strong>。<br>为了<strong>方便对对象内部数据的操</strong>作，设置为friend友元函数。<br>为了能达到cout&lt;&lt;对象&lt;&lt;对象&lt;&lt;endl;的连续输出对象的效果，<strong>设置返回类型为引用</strong>。</p>
<p><strong>参数</strong>：第一个为输出流对象。第二个为要输出的对象（<strong>为了防止产生临时对象、提高程序的效率，将参数设置为引用类型，但引用类型又不想让它改变实参的值，所以设置为const</strong>）。<br>例子：<br>friend ostream&amp; operator&lt;&lt;(ostream&amp; o,const Person&amp; p)（<strong>输出运算符重载</strong>）<br>{<br> o&lt;&lt;”名字”&lt;&lt;p.name&lt;&lt;”年龄”&lt;&lt;p.age&lt;&lt;”身高”&lt;&lt;p.height&lt;&lt;”体重”&lt;&lt;p.weight&lt;&lt;”.\n”;<br> return o;<br>}</p>
<p>friend istream&amp; operator&lt;&lt;(istream&amp; i, Person&amp; p)（<strong>输入运算符重载</strong>）<br>{<br>i&gt;&gt;p.name&gt;&gt;p.age&gt;&gt;p.height&gt;&gt;p.weight;<br> return i;<br>}</p>
<p>2.friend关键字<br>c++中有个friend关键字，它能让被修饰的对象冲破本class的封装特性，从而能够访问本class的私有对象。<br>简单来讲，就是：<br>•    如果你在A类中，申明了函数func()是你的friend，那么func()就可以使用A类的所有成员变量，无论它在什么地方定义的。<br>•    如果你在A类中，申明了B类是你的friend，那么B类中的方法就可以访问A类的所有成员变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">using namespace std;</div><div class="line"></div><div class="line">class A &#123;</div><div class="line">public:</div><div class="line">    A() &#123;</div><div class="line">        password = 1111;</div><div class="line">        birthday = 808;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ~A() &#123; &#125;</div><div class="line"></div><div class="line">    friend int func(A a); // 向c++表示，int func(A a)是我的朋友，所以它可以使用我的所有东西。</div><div class="line">    friend class B;       // 向c++表示，class B是我的朋友，所以它可以使用我的所有东西。</div><div class="line"></div><div class="line">private:</div><div class="line">    int password;</div><div class="line">    int birthday;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">int func(A a) &#123;</div><div class="line">    cout &lt;&lt; a.password &lt;&lt; &quot; and &quot; &lt;&lt; a.birthday &lt;&lt; endl; //可以访问</div><div class="line">    a.password = 1;                                      //甚至可以修改</div><div class="line">    cout &lt;&lt; a.password &lt;&lt; endl;</div><div class="line">    return 0;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class B &#123;</div><div class="line">public:</div><div class="line">    B() &#123; &#125;</div><div class="line"></div><div class="line">    ~B() &#123; &#125;</div><div class="line">    // 因为在A类中已经声明了B类是它的朋友，所以B类中方法就可以访问A类的私有变量了</div><div class="line">    void show(A a) &#123;</div><div class="line">        cout &lt;&lt; &quot;your account is &quot; &lt;&lt; a.account &lt;&lt; &quot; and with pass: &quot; &lt;&lt; a.password &lt;&lt; endl;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">private:</div><div class="line">&#125;;</div><div class="line"></div><div class="line">int main() &#123;</div><div class="line"></div><div class="line">    A a;</div><div class="line">    func(a);</div><div class="line">    B b;</div><div class="line">    b.show(a);</div><div class="line">    system(&quot;pause&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>加上运算符重载：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">using namespace std;</div><div class="line"></div><div class="line">class A &#123;</div><div class="line">public:</div><div class="line">    A() &#123;</div><div class="line">        password = 1111;</div><div class="line">        account = 808;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ~A() &#123; &#125;</div><div class="line"></div><div class="line">    friend ostream&amp; operator &lt;&lt; (ostream &amp;os , A a);</div><div class="line"></div><div class="line">private:</div><div class="line">    int password;</div><div class="line">    int account;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">ostream&amp; operator &lt;&lt; (ostream &amp;os , A a) &#123;</div><div class="line">    os &lt;&lt; &quot;your account is &quot; &lt;&lt; a.account &lt;&lt; &quot; and with pass: &quot; &lt;&lt; a.password &lt;&lt; endl;</div><div class="line">    return os;</div><div class="line">&#125;</div><div class="line"></div><div class="line">int main() &#123;</div><div class="line"></div><div class="line">    A a;</div><div class="line"></div><div class="line">    cout &lt;&lt; a;</div><div class="line"></div><div class="line">    system(&quot;pause&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/14/多尺度Gabor滤波器提取彩色图像边缘/" itemprop="url">
                  多尺度Gabor滤波器提取彩色图像边缘
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-14T18:17:23+08:00" content="2017-06-14">
              2017-06-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/图像处理/" itemprop="url" rel="index">
                    <span itemprop="name">图像处理</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/14/多尺度Gabor滤波器提取彩色图像边缘/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/14/多尺度Gabor滤波器提取彩色图像边缘/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="一、-多尺度Gabor滤波算法的基本原理和实现思路"><a href="#一、-多尺度Gabor滤波算法的基本原理和实现思路" class="headerlink" title="一、    多尺度Gabor滤波算法的基本原理和实现思路"></a>一、    多尺度Gabor滤波算法的基本原理和实现思路</h4><p>由于Gabor特征对光照、姿态具有一定的鲁棒性，Gabor特征具有良好的空间局部性和方向选择性，可以很好的描述图像的纹理信息，因此许多算法都采用Gabor特征作为识别特征。<br>该算法仅对图像中部分关键特征点进行Gabor变换，并将这些特征点位置为顶点、以其Gabor变换系数为顶点属性、以其关键点位置关系为边属性的属性图，从而将问题转化为图匹配问题。通过合理的选择特征点的位置，弹性图可以很好地同时对关键局部特征及其它们之间的关系进行建模，从而既利用了图像亮度分布特征，又利用了结构信息。GWN方法从最佳描述的角度，通过一个优化过程完全自动地确定特征位置及其相应的小波参数，并最终用这些参数作为描述来进行人脸识别。但GWN是一种基于参数优化的建模方法，计算复杂度很高。GFC算法的基本思想是在粗略对齐图像的前提下，逐像素计算每个像素点的多方向、多尺度Gabor变换特征，形成Gabor特征的表示，然后进一步用Fisher判别分析法提取特征，为了解决逐像素Gabor特征维数过高的问题，Liu采用了简单的下采样处理方法。AdaGabor算法采用AdaBoost算法对高维Gabor特征进行选择的降维，该方法采用机器学习的方法更加客观地利用Gabor特征，从而能在有效降维的同时提高识别性能。<br>Gabor小波与人类视觉系统中简单细胞的视觉刺激响应非常相似。它在提取目标的局部空间和频率域信息方面具有良好的特性。虽然Gabor小波本身并不能构成正交基，但在特定参数下可构成紧框架。Gabor小波对于图像的边缘敏感，能够提供良好的方向选择和尺度选择特性，而且对于光照变化不敏感,能够提供对光照变化良好的适应性。上述特点使Gabor小波被广泛应用于视觉信息理解。二维Gabor小波变换[15]是在时频域进行信号分析处理的重要工具，其变换系数有着良好的视觉特性和生物学背景，因此被广泛应用于图像处理、模式识别等领域。与传统的傅立叶变换相比，Gabor小波变换具有良好的时频局部化特性。即非常容易地调整Gabor滤波器的方向、基频带宽及中心频率从而能够最好的兼顾信号在时空域和频域中的分辨能力；Gabor小波变换具有多分辨率特性即变焦能力。即采用多通道滤波技术，将一组具有不同时频域特性的Gabor小波应用于图像变换，每个通道都能够得到输入图像的某种局部特性，这样可以根据需要在不同粗细粒度上分析图像。此外，在特征提取方面，Gabor小波变换与其它方法相比：一方面其处理的数据量较少，能满足系统的实时性要求；另一方面，小波变换对光照变化不敏感，且能容忍一定程度的图像旋转和变形，当采用基于欧氏距离进行识别时，特征模式与待测特征不需要严格的对应，故能提高系统的鲁棒性。<br>无论从生物学的角度还是技术的角度，Gabor特征都有很大的优越性。Jones和Palmer的研究表明，在基本视觉皮层里的简单细胞的感受野局限在很小的空域范围内，并且高度结构化。Gabor变换所采用的核（Kernels）与哺乳动物视觉皮层简单细胞2D感受野剖面（Profile）非常相似，具有优良的空间局部性和方向选择性，能够抓住图像局部区域内多个方向的空间频率（尺度）和局部性结构特征。这样，Gabor分解可以看作一个对方向和尺度敏感的有方向性的显微镜。同时，二维Gabor函数也类似于增强边缘以及峰、谷、脊轮廓等底层图像特征，这相当于增强了被认为是面部关键部件的眼睛、鼻子、嘴巴等信息，同时也增强了诸于黑痣、酒窝、伤疤等局部特征从而使得在保留总体人脸信息的同时增强局部特性成为可能。<br>从图像处理的角度来看，Gabor特征有如下好处：<br>（1）Gabor核函数由于去掉了直流分量，因此对局部光照的变化不敏感，常常被用在要求对光照有适应性的场合；<br>（2）Gabor滤波结果可以反映图像不同尺度、不同方向上的灰度分布信息。一般说来，大尺度滤波可以反映全局性较强的信息，同时可以掩盖图像中噪声的影响；小尺度可以反映比较精细的局部结构，但容易受到噪声影响。<br>小波核函数在空域和频域上都有一定的局域性，这使得其对平移、拉伸、旋转和尺度变换都具有一定的鲁棒性。虽然平移变换对复向量的相位有一定影响，但在人脸识别这个问题中，平移对结果的影响是要考虑的，Gabor特征仍然具有很好的刻画特性。正是由于Gabor特征的这些特性，使得其在识别中得到了非常广泛的应用。</p>
<p>二维Gabor函数：<br><img src="http://ols4zt49w.bkt.clouddn.com/1497435908%281%29.png" alt=""></p>
<p>v的取值决定了Gabor滤波的波长，u的取值表示Gabor核函数的方向，K表示总的方向数。参数 决定了高斯窗口的大小，这里取σ=pi/3(可调)。程序中取3个频率，即尺度（v=0, 1, 2），16个方向（即K=16，u＝0, 1, … ,15），共48个Gabor核函数。从而获得较好的小波表征和辨别效果。<br>   Gabor变换与Gabor内核卷积为：<br><img src="http://ols4zt49w.bkt.clouddn.com/1497435962%281%29.png" alt=""><br>设的幅值和相位分别为组合不同尺度和方向的，构成图像在位置处的Gabor特征矢量。<br>定义Gabor特征和在不考虑相位差时的相似性为：<br><img src="http://ols4zt49w.bkt.clouddn.com/1497435968%281%29.png" alt=""><br>在提取人脸图像的Gabor特征时，通常采用多个在不同尺度和方向上的Gabor滤波器组成滤波器组，并根据图像的特点和神经生理学的结论来选择参数。通常研究采用共包括8个方向和5个尺度的Gabor滤波器组，使滤波器的带宽约为1倍频程。(在此题中采用3尺度，16方向)<br>由于Gabor特征具有良好的空间局部性和方向选择性，而且对光照、姿态具有一定的鲁棒性，因此在人脸识别中获得了成功的应用。然而，大部分基于Gabor特征的人脸识别算法中,只应用了Gabor幅值信息，而没有应用相位信息，主要原因是Gabor相位信息随着空间位置呈周期性变化，而幅值的变化相对平滑而稳定。所以本论文将输入图像依次与滤波器组的各个滤波器进行卷积，并取其幅值作为输出，即<br><img src="http://ols4zt49w.bkt.clouddn.com/1497435977%281%29.png" alt=""><br>设通过40个滤波器得到Gabor特征的维数高达 ，计算量很大，且由于Gabor特征在相邻像素间是高度相关和冗余的，所以通常只需要稀疏的提取部分节点上的Gabor特征。</p>
<h4 id="二、-自选示例图像，并说明选择原则"><a href="#二、-自选示例图像，并说明选择原则" class="headerlink" title="二、    自选示例图像，并说明选择原则"></a>二、    自选示例图像，并说明选择原则</h4><p>在这里，我选用了lena的图片，主要考虑到为了突出Gabor的优点，所以选了一张：局部光照的变化不敏感，有局部细节结构的图。<br><img src="http://ols4zt49w.bkt.clouddn.com/1497437101%281%29.png" alt=""></p>
<h4 id="三、-所编写程序对示例图像的运算结果"><a href="#三、-所编写程序对示例图像的运算结果" class="headerlink" title="三、    所编写程序对示例图像的运算结果"></a>三、    所编写程序对示例图像的运算结果</h4><p>在这里，我采用的多尺度Gabor滤波器运行结果如图：<br><img src="http://ols4zt49w.bkt.clouddn.com/1497436718%281%29.png" alt=""></p>
<p>为了突出优点，通过比较其他不同算子。<br>主要比较prewitt算子和canny算子，比较结果如下：<br><img src="http://ols4zt49w.bkt.clouddn.com/1497436859%281%29.png" alt=""><br><img src="http://ols4zt49w.bkt.clouddn.com/1497437029%281%29.png" alt=""></p>
<h4 id="四、-基于运算结果，对比分析所编写程序的适用场合"><a href="#四、-基于运算结果，对比分析所编写程序的适用场合" class="headerlink" title="四、    基于运算结果，对比分析所编写程序的适用场合"></a>四、    基于运算结果，对比分析所编写程序的适用场合</h4><p>通过比较，不难发现：<br>Prewitt算子,检测方法对灰度渐变和噪声较多的图像处理效果较好。但边缘较宽，而且间断点多。<br>canny算法,虽然能检测到一定的弱边缘，间断点较少，但是对一些灰度变化较小的边缘没有检测到。（眼睛等）<br>Gabor算法,对图像的边缘检测对噪声具有更好的鲁棒性，边缘的断裂点更少，对边缘的检测更加准确。<br>因此：Gabor特征对光照、姿态具有一定的鲁棒性，Gabor小波对于图像的边缘敏感，能够提供良好的方向选择和尺度选择特性，而且对于光照变化不敏感,能够提供对光照变化良好的适应性。上述特点使Gabor小波被广泛应用于视觉信息理解。</p>
<h4 id="五、-matlab程序清单及重要函数与语句的注释说明"><a href="#五、-matlab程序清单及重要函数与语句的注释说明" class="headerlink" title="五、    matlab程序清单及重要函数与语句的注释说明"></a>五、    matlab程序清单及重要函数与语句的注释说明</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">I=imread(&apos;lena.bmp&apos;); </div><div class="line">I=rgb2gray(I);</div><div class="line"></div><div class="line">figure;</div><div class="line">imshow(I);</div><div class="line">[height width ]=size(I);</div><div class="line">J=zeros(height,width); %初始化</div><div class="line"></div><div class="line">%u=16;</div><div class="line">v=3; %尺度</div><div class="line">for u=0:15   %orientations 0-15  %方向</div><div class="line">   </div><div class="line"></div><div class="line">sigma = pi/3;%pi*sqrt(2^(-v/2-1));%pi*2;   %参数可调，此处采用π/3</div><div class="line">sigma_2 = sigma^2;</div><div class="line"></div><div class="line">kv = pi*2^(-v/2-1);</div><div class="line">phiu = u*pi/16; %采样方向</div><div class="line"></div><div class="line">sigma_rule = 3*sigma/kv;    %3 sigma rule</div><div class="line"></div><div class="line">kjx = kv*cos(phiu);</div><div class="line">kjy = kv*sin(phiu);</div><div class="line"></div><div class="line">for x = -sigma_rule:sigma_rule</div><div class="line">    for y = -sigma_rule:sigma_rule</div><div class="line">        gaussian_kernal = kv^2/sigma_2*exp(-kv^2*(x^2+y^2)/(2*sigma_2)); %gaussian kernal function</div><div class="line">        </div><div class="line">        if (abs(x)&lt;=sigma_rule &amp; abs(y)&lt;=sigma_rule)</div><div class="line">            gabor_real(x+sigma_rule+1,y+sigma_rule+1) = gaussian_kernal * (cos(kjx*x+kjy*y)-exp(-sigma_2/2));</div><div class="line">            gabor_imag(x+sigma_rule+1,y+sigma_rule+1) = gaussian_kernal * sin(kjx*x+kjy*y);</div><div class="line">        else</div><div class="line">            gabor_real(x+sigma_rule+1,y+sigma_rule+1) = 0;</div><div class="line">            gabor_imag(x+sigma_rule+1,y+sigma_rule+1) = 0;</div><div class="line">        end</div><div class="line"></div><div class="line">    end</div><div class="line">end</div><div class="line"></div><div class="line">Imgabout1 = conv2(I,double(gabor_imag),&apos;same&apos;);%返回相同大小的二维卷积的虚部</div><div class="line">Regabout1 = conv2(I,double(gabor_real),&apos;same&apos;);%实部</div><div class="line">gabout1 = Regabout1;</div><div class="line"></div><div class="line">     J=J+gabout1;</div><div class="line">    end</div><div class="line"></div><div class="line">J=J/16;</div><div class="line">for i=1:height</div><div class="line">    for j=1:width</div><div class="line">        if (J(i,j)&lt;-5)</div><div class="line">            J(i,j)=0;</div><div class="line">        else J(i,j)=1;</div><div class="line">        end</div><div class="line">    end</div><div class="line">end</div><div class="line">G=[J-min(min(J))]*255/[max(max(J))-min(min(J))];  %归一化，再标准化</div><div class="line">G=uint8(G);</div><div class="line">figure,imshow(G);</div><div class="line"></div><div class="line">J=medfilt2(J); %使用默认的3×3邻域执行矩阵A的中值滤波。</div><div class="line">figure,imshow(J);</div></pre></td></tr></table></figure>
<p>补充：后来有尝试了其他类似的图片，效果如下：<br><img src="http://ols4zt49w.bkt.clouddn.com/1497437341.png" alt=""><br><img src="http://ols4zt49w.bkt.clouddn.com/1497437353%281%29.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/06/linux下搭建qt编译环境常遇到的问题及解决/" itemprop="url">
                  linux下搭建qt编译环境常遇到的问题及解决
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-06T18:49:14+08:00" content="2017-06-06">
              2017-06-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/QT/" itemprop="url" rel="index">
                    <span itemprop="name">QT</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/06/linux下搭建qt编译环境常遇到的问题及解决/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/06/linux下搭建qt编译环境常遇到的问题及解决/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>简要概括以下步骤：<br>一、下载QT版本以及gcc</p>
<p>二、解压，安装，编译，这个网上教程很多，我是参考的迅为的开发板使用手册。<br><strong>这里重点是补充报错及修复:</strong><br>1.没有安装<strong>g++</strong>,  <strong>如果你是一开始安装新的linux系统定会有这样问题</strong>， 自己<code>apt-get install g++</code>处理下。</p>
<p>2.没有相关的配置的库支持，可以用<code>apt-get isntall build-essential</code> 添加下载库支持</p>
<p>3.运行qt时候会有报错：Qt编译错误“GL/gl.h:No such file or directory或者提示找不到GL等。<br><strong>解决</strong>：这是由于系统中没有安装OpenGL库导致的，于是在控制台中输入以下命令安装OpenGL库及其工具：<code>apt-get install libgl1-mesa-dev libglu1-mesa-dev freeglut3-dev</code> 即可。</p>
<p>三，注意配置下qt的编译器和qt版本。具体根据自己安装的目录来吧。<br>（一般在/usr/bin/<strong>g++</strong>）</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/03/linux输入登陆密码正确，闪回登陆界面，无法登陆/" itemprop="url">
                  linux输入登陆密码正确，闪回登陆界面，无法登陆
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-03T20:13:25+08:00" content="2017-06-03">
              2017-06-03
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/03/linux输入登陆密码正确，闪回登陆界面，无法登陆/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/03/linux输入登陆密码正确，闪回登陆界面，无法登陆/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近遇到一个头疼的问题，在登陆linux系统时输入密码正确，但却老是闪回登陆界面，无法登陆。我参考了网上的方法，却仍然发现走了一些弯路，主要网上有的解释太过简略或者有点局限，甚至还是错的。在此，我结合我解决的过程，主要做个总结。</p>
<h5 id="产生原因"><a href="#产生原因" class="headerlink" title="产生原因"></a>产生原因</h5><p>问题的原因：主目录下的.Xauthority文件拥有者变成了root，从而以用户登陆的时候无法都取.Xauthority文件 。<br><strong>注意：这里的主目录是你登陆的用户，不是root用户</strong><br><strong>说明：</strong>Xauthority，是<strong>startx</strong>脚本记录文件。Xserver启动时，读文件~/.Xauthority,读入对应其display 的记录。当一个需要显示的客户程序启动调用XOpenDisplay()也读这个文 件，并把找到的magic code 发送给 Xserver。当Xserver验证这个magic code正确以后，就同意连接啦。观察startx脚本也可以看到，每次startx 运行，都在调用xinit以前使用了xauth的add命令添加了一个新的记录到~/.Xauthority，用来这次运行X使用认证。(<strong>注意：一般sudo startx后就这样不能登陆了</strong>)</p>
<h5 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h5><p>1.在需要输入密码的登陆界面，按下ctrl+alt+F1组合键，进入tty1终端<br><img src="http://ols4zt49w.bkt.clouddn.com/1496493167%281%29.png" alt=""><br><img src="http://ols4zt49w.bkt.clouddn.com/1496492971%281%29.png" alt=""><br>2.输入登陆ubuntu时的用户名和密码，在tty1终端出现登陆成功的提示，这里我的用户名是topeet，默认进入当前用户主目录（我的是/home/topeet）,可以用pwd命令查看，若不是，则切换至：<br>cd  或者<br>cd /home/topeet/ 注意：我这里的用户名是topeet,根据自己的实际情况更改。<br><img src="http://ols4zt49w.bkt.clouddn.com/1496493023%281.png" alt=""><br>3.执行命令，将Xauthority的拥有者改为用户topeet<br>$ sudo chown topeet:topeet .Xauthority<br>备注：本人的用户名为topeet，因此 chown后面跟了topeet:topeet若为其他用户名修改成相应的名称即可）<br>(我的用户和用户组都是topeet,如果你不知道可以用<code>more /etc/group</code>及<code>more /etc/passwd</code>查看)<br><img src="http://ols4zt49w.bkt.clouddn.com/1496493060%281.png" alt=""><br>4.然后在终端提示符后输入：$ ls .Xauthority -l<br>正确无误后显示如下：-rw——- 1 topeet topeet 51  May 22 23:14 .Xauthority<br>此时拥有者已经变为用户。<br><img src="http://ols4zt49w.bkt.clouddn.com/1496493097%281.png" alt=""><br>5.按下ctrl + alt + F7切换回图形登陆界面登陆即可。<br><strong>易错点：</strong><br>一开始我是切换到root用户下修改.Xauthority文件的拥有者的，但是试了几次都没成功，在次特别强调按下ctrl+alt+F1组合键，进入tty1终端后登入你想登入的账户，而不是root用户。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/02/逐行读写字符串数组到文本txt文件/" itemprop="url">
                  逐行读写字符串数组到文本txt文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-02T14:31:30+08:00" content="2017-06-02">
              2017-06-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/c-c/" itemprop="url" rel="index">
                    <span itemprop="name">c/c++</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/02/逐行读写字符串数组到文本txt文件/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/02/逐行读写字符串数组到文本txt文件/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在c和c++代码的操作中，我们有时会用到一些文件操作，为了方便以后的调用，我在此总结了一些简单的文件读写操作，并依次展示效果。</p>
<h4 id="C语言方式"><a href="#C语言方式" class="headerlink" title="C语言方式"></a>C语言方式</h4><p>在代码中，主要用到了以下几个头文件：为了方便，此处将几次代码的头文件汇到了一起，你可以直接复制过去。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt; //c++的</div><div class="line">#include&lt;stdio.h&gt;  //c的</div><div class="line">#include&lt;string&gt;</div><div class="line">#include&lt;fstream&gt; //c++文件读写操作函数</div><div class="line">using namespace std;</div></pre></td></tr></table></figure></p>
<h5 id="fprintf-函数将字符串数组写入到txt文件中"><a href="#fprintf-函数将字符串数组写入到txt文件中" class="headerlink" title="fprintf()函数将字符串数组写入到txt文件中"></a>fprintf()函数将字符串数组写入到txt文件中</h5><p>此处的fprintf()函数：输出函数(格式化输出数据至文件)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">   FILE *fp;</div><div class="line">errno_t err;</div><div class="line">char * name[] = &#123; &quot;file1&quot;, &quot;file2&quot;, &quot;file3&quot;, &quot;file4&quot;, &quot;file5&quot; &#125;;</div><div class="line">if((err=fopen_s(&amp;fp,&quot;E://test.txt&quot;, &quot;w&quot;))!=0)</div><div class="line">   printf(&quot;the file was not opened\n&quot;);</div><div class="line">      </div><div class="line">for (int i = 0; i &lt; 5; i++)</div><div class="line">&#123;</div><div class="line">	fprintf(fp, &quot;%s\n&quot;, name[i]);</div><div class="line">&#125;</div><div class="line">   </div><div class="line">fclose(fp);</div></pre></td></tr></table></figure></p>
<p>此处，补充一点知识，在vs里经常遇到：<br><strong>fopen的用法是: fp  = fopen(filename, “w”)。<br>而对于fopen_s来说，还得定义另外一个变量errno_t  err，然后err = fopen_s(&amp;fp, filename, “w”)。<br>返回值的话，对于fopen来说，打开文件成功的话返回文件指针（赋值给fp），打开失败则返回NULL值；<br>对于fopen_s来说，打开文件成功返回0，失败返回非0。</strong></p>
<p>最终效果如图：<br><img src="http://ols4zt49w.bkt.clouddn.com/51N_X%281B6$EIC$W~ORIV%25%7DT.png" alt=""></p>
<h5 id="使用fputs函数逐行写入文本"><a href="#使用fputs函数逐行写入文本" class="headerlink" title="使用fputs函数逐行写入文本"></a>使用fputs函数逐行写入文本</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">   char *InputStr = &quot;that is ok&quot;;</div><div class="line">FILE* fp;</div><div class="line">errno_t err;</div><div class="line">if ((err = fopen_s(&amp;fp, &quot;C://1.txt&quot;, &quot;wt&quot;)) != 0)</div><div class="line">	printf(&quot;the file was not opened\n&quot;);</div><div class="line">//FILE* fp = fopen(&quot;C:\\1.txt&quot;, &quot;wt&quot;);</div><div class="line">//if (fp != NULL)</div><div class="line">//&#123;</div><div class="line">	fseek(fp, 0, SEEK_END);</div><div class="line">	fputs(InputStr, fp);</div><div class="line">	fputs(&quot;\r\n&quot;, fp);</div><div class="line">	fclose(fp);</div><div class="line">//&#125;</div></pre></td></tr></table></figure>
<p>最终效果：<br><img src="http://ols4zt49w.bkt.clouddn.com/M_8VG%5BRJM5%7D%5BPA95%7B6%254V%60A.png" alt=""></p>
<h5 id="利用fscanf对文件进行格式化输入，读取文件中的数据"><a href="#利用fscanf对文件进行格式化输入，读取文件中的数据" class="headerlink" title="利用fscanf对文件进行格式化输入，读取文件中的数据"></a>利用fscanf对文件进行格式化输入，读取文件中的数据</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">   int i = 0;</div><div class="line">FILE *fp;</div><div class="line">fopen_s(&amp;fp,&quot;E://test.txt&quot;, &quot;r&quot;);</div><div class="line">char  name[6][10] = &#123;0&#125;;//如果没有初始化，最后没有读取的几位将会乱码。整个字符数组输出，如未初始化，则没有写入确定值的元素是一些不确定值，输出可能就是一堆乱码了。</div><div class="line"></div><div class="line">while (!feof(fp))</div><div class="line">&#123;</div><div class="line">	fscanf_s(fp, &quot;%s&quot;, name[i],sizeof(name[i]));</div><div class="line">	printf(&quot;%s\n&quot;, name[i]);</div><div class="line">	i++;</div><div class="line">&#125;</div><div class="line">fclose(fp);</div></pre></td></tr></table></figure>
<p><strong>注意：整个字符数组输出，如未初始化，则没有写入确定值的元素是一些不确定值，输出可能就是一堆乱码了。</strong><br>效果如下：<br><img src="http://ols4zt49w.bkt.clouddn.com/K4FYVZ5$%29OIJ@_%6007%7DJ%60~%5B5.png" alt=""></p>
<h4 id="C-语言方式"><a href="#C-语言方式" class="headerlink" title="C++语言方式"></a>C++语言方式</h4><p>在看具体实例前，我先简要介绍一下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#include &lt;fstream&gt;  </div><div class="line">ofstream         //文件写操作 内存写入存储设备   </div><div class="line">ifstream         //文件读操作，存储设备读区到内存中  </div><div class="line">fstream          //读写操作，对打开的文件可进行读写操作</div></pre></td></tr></table></figure></p>
<p>下面主要列举两个例子，一个是从文件里读取数据，然后控制台输出；另一个是读取一个文件数据，并将数据写入另一个文件，即复制。</p>
<h5 id="c-读文件"><a href="#c-读文件" class="headerlink" title="c++读文件"></a>c++读文件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">   ifstream in(&quot;E://test.txt&quot;);</div><div class="line">string filename;</div><div class="line">string line;</div><div class="line"></div><div class="line">if (in) // 有该文件</div><div class="line">&#123;</div><div class="line">	while (getline(in, line)) // line中不包括每行的换行符</div><div class="line">	&#123;</div><div class="line">		cout &lt;&lt; line &lt;&lt; endl;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">else // 没有该文件</div><div class="line">&#123;</div><div class="line">	cout &lt;&lt; &quot;no such file&quot; &lt;&lt; endl;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>效果如下：<br><img src="http://ols4zt49w.bkt.clouddn.com/79%25%25GY~48KKPO%5B3LT%28K%5BO1U.png" alt=""></p>
<h5 id="c-文件间数据的复制"><a href="#c-文件间数据的复制" class="headerlink" title="c++文件间数据的复制"></a>c++文件间数据的复制</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">/*实现读取文件file1，写入到文件file2，实现复制*/</div><div class="line">void fileCopy(char *file1, char *file2)</div><div class="line">&#123;</div><div class="line">	// 最好对file1和file2进行判断</div><div class="line"></div><div class="line">	ifstream in(file1);</div><div class="line">	ofstream out(file2);</div><div class="line">	string filename;</div><div class="line">	string line;</div><div class="line"></div><div class="line">	while (getline(in, line))</div><div class="line">	&#123;</div><div class="line">		out &lt;&lt; line &lt;&lt; endl;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    fileCopy(&quot;E://1.txt&quot;, &quot;E://2.txt&quot;);</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>效果如下：<br><img src="http://ols4zt49w.bkt.clouddn.com/ZPH%28KD016GH%25HN%7B%7D~5T%28DJM.png" alt=""><br><strong>补充</strong>：这里只是简单的文件操作，关于<strong>c++</strong>的文件读写详解可以参考：<br><strong>C++</strong>文件读写详解（ofstream,ifstream,fstream） <a href="http://blog.csdn.net/kingstar158/article/details/6859379" target="_blank" rel="external">http://blog.csdn.net/kingstar158/article/details/6859379</a><br>里面还包含一些二进制文件，缓存与同步等。<br><strong>扩展：</strong><br>C++的输入输出分为三种：<br>(1)基于控制台的I/O，头文件iostream<br>(2)基于文件的I/O, 头文件fstream<br>(3)基于字符串的I/O,头文件sstream<br>具体参考博客：<a href="http://www.cnblogs.com/gamesky/archive/2013/01/09/2852356.html" target="_blank" rel="external">http://www.cnblogs.com/gamesky/archive/2013/01/09/2852356.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/01/c-11-新特性/" itemprop="url">
                  c++11新特性
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-01T21:50:54+08:00" content="2017-06-01">
              2017-06-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/c-c/" itemprop="url" rel="index">
                    <span itemprop="name">c/c++</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/01/c-11-新特性/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/01/c-11-新特性/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>C++</strong>面试中经常会被问到的一个问题是:了解哪些 C++11 新特性，下面总结几条实用的新特性,注意以下不是全部，只是部分，在以后学习的过程中继续补充。</p>
<h5 id="1-右值的引用"><a href="#1-右值的引用" class="headerlink" title="1.右值的引用"></a>1.右值的引用</h5><p>传统的 <strong>C++</strong> 引用（现在称为左值引用）使标识符关联到左值。左值是一个表示数据的表达式（如变量名或解除引用的指针）。C++11 新增了右值引用，使用 <strong>&amp;&amp; </strong>表示。右值则包括字面常量、诸如 x + y 表达式以及返回值的函数。记住一点，<strong>左值与右值的根本区别在于能否获取内存地址，而能否赋值不是区分的依据</strong>。<br>下面简要总结一下<strong>引用和指针的区别</strong>：<br>两者都是与地址相关的概念。<strong>引用是变量的别名，而指针则是变量的地址</strong><br>区别如下：<br>==1.指针是一个实体（分配内存），而引用仅是个别名；<br>2.引用只能在定义时被初始化一次，之后不可变；指针可变；引用“从一而终”，指针可以“见异思迁”；<br>3.引用没有const，指针有const，const的指针不可变；<br>4.引用不能为空，指针可以为空；<br>5.“sizeof 引用”得到的是所指向的变量(对象)的大小，而“sizeof 指针”得到的是指针本身的大小；<br>从上面可以看出引用更接近 const 指针。==<br>引入右值引用的主要目的之一是实现移动语义，下面展开来谈==</p>
<h5 id="2-移动语句"><a href="#2-移动语句" class="headerlink" title="2.移动语句"></a>2.移动语句</h5><p>为方便理解移动语句，考虑下面的示例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">vector&lt;string&gt; allcpas(const vector&lt;string&gt; &amp;vs)</div><div class="line">&#123;</div><div class="line">    vector&lt;string&gt; temp;</div><div class="line">    // 将 vs 复制给 temp</div><div class="line">    return temp;</div><div class="line">&#125;</div><div class="line">vector&lt;string&gt; vstr;</div><div class="line">// vstr 是包含 20000 个 string 的向量，每个元素有 1000 个字符</div><div class="line">vector&lt;string&gt; vstr_copy1(vstr);</div><div class="line">vector&lt;string&gt; vstr_copy2(allcps(vstr));    // #2</div></pre></td></tr></table></figure></p>
<p>对语句# 2， <code>allcps</code> 将返回值 temp 复制给临时形参变量，再将该形参复制给<code>vstr_copy2</code> 。编译器对 vstr 复制了两次。这样显然很消耗资源。如果将对数据的所有权直接转让给 <code>vstr_copy2</code> ，显然会更好，对此我们只需要实现 vstr_copy2 的<strong>移动构造函数</strong>，在函数内部将调整临时变量的所有权，从而避免一次无意义的复制。移动语义实际上避免了移动原始数据，而只是修改了记录。</p>
<h5 id="3-基于范围的for循环"><a href="#3-基于范围的for循环" class="headerlink" title="3.基于范围的for循环"></a>3.基于范围的for循环</h5><p>对于内置数组已经包含 <code>begin()</code> 和 <code>end()</code> 的类和 STL 容器，基于范围的 for 循环可以简化为它们编写循环的工作。这种循环对数组或容器中的每个元素执行指定的操作：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">std::vector&lt;int&gt; vi(6);</div><div class="line">for (auto &amp;x : vi)</div><div class="line">    x = std::rand()</div></pre></td></tr></table></figure></p>
<p>x 依次为 vi 中的每个元素的引用，从而实现了对数组每个元素的修改。</p>
<h5 id="4-智能指针"><a href="#4-智能指针" class="headerlink" title="4.智能指针"></a>4.智能指针</h5><p>智能指针的出现很自然，其行为类似于指针的类对象，可以在离开对象周期使自动析构函数，释放动态申请的内存。<br>模板 <code>auto_ptr</code> 是 <strong>c++98</strong> 提供的解决方案，C++11 已将其摈弃，并提供了 unique_ptr ，shared_ptr 两种解决方案。<br>智能指针很多方面都类似于常规指针。例如，如果 ps 是一个智能指针对象，则可以对它执行解除引用操作（*ps）、用它来访问结构成员，将他赋值给相同类型的常规指针。将智能指针对象赋值给对另一个同类型的智能指针对象，将引起一个问题。看下面例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">auto_ptr&lt;string&gt; ps (new string(&quot;I reigned lonely as a cloud.&quot;));</div><div class="line">auto_ptr&lt;string&gt; vocation;</div><div class="line">vocation = ps;</div></pre></td></tr></table></figure></p>
<p>两个指针指向同一块内存，会造成程序试图删除同一个对象两次。避免这种问题，有如下思路：<br>1.建立所有权的概念，对于特定的指针，只能有一个智能指针对象可以拥有它。让赋值操作转让所有权。这就是用于 auto_ptr 和 unique_ptr 的策略。<br>2.创建智能更高的指针，跟踪引用计数特定对象的智能指针数。这称为引用计数。例如，赋值计数加1，过期时，计数减1。仅当最后一个指针过期时，才调用 delete。这是 shared_ptr 采用的策略。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/18/QT5-3-2连接Mysql老是失败！/" itemprop="url">
                  QT5.3.2连接Mysql老是失败！
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-05-18T17:00:13+08:00" content="2017-05-18">
              2017-05-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/QT/" itemprop="url" rel="index">
                    <span itemprop="name">QT</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/05/18/QT5-3-2连接Mysql老是失败！/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/18/QT5-3-2连接Mysql老是失败！/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前在QT里一直用的文件型数据库sqlite,今天突然想试试在里面连接Mysql，结果却遇到了一个问题，问题如下：<br>在程序运行后，显示的驱动里明明有QMYSQL驱动，同时我也成功创建了一个mydata数据库，但是就是显示加载不了驱动。<br><img src="http://ols4zt49w.bkt.clouddn.com/1495098343%281%29.png" alt=""><br><img src="http://ols4zt49w.bkt.clouddn.com/1495098462%281%29.png" alt=""></p>
<p>网上的解决方案很多，大概有：<br>1.需要自己编译驱动。（qmysql.dlll,qmysqld.dll已经存在）<br>2.将mysql目录下lib中的libmysql.dll考到Qt安装目录bin中。<br>3.将plugins\sqldrivers文件夹拷贝到工程目录及其目标文件中。<br>结果都是一个效果，无效！！！不能不说网上有的回答并不全面或者说是牛头不对马嘴，也因此坑了我一个下午，最终得已解决，在此为了避免你们遇到跟我一样得问题，我在这里总结一下：</p>
<p>1.从Qt5.2版本开始，已经包含了MySQL驱动，不需要在手动编译了。你可以通过qDebug()&lt;&lt;QSqlDatabase::drivers()查看支持的驱动。</p>
<p><strong>2.还有一个很重要的是32位的MySQL对应32位的Qt。</strong></p>
<p>相信你们也发现了，解决方案很简单。由于<strong>我的版本是QT5.3,而且x86的，即32位的</strong>，虽然我的电脑是64位win10系统，但是在<strong>电脑上必须装32位的Mysq</strong>l。相信大家会有疑惑，64位的系统怎么能装32位的软件呢，但是奇葩的是竟然成功装上了，至少 mysql-5.5.27-win32.msi 可以。<br>接下来再将mysql目录下lib中的libmysql.dll考到Qt安装目录bin中。<br>在此编译运行，结果如下：<br><img src="http://ols4zt49w.bkt.clouddn.com/1495100021%281%29.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://gss0.baidu.com/9fo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/3812b31bb051f8196c5029e9d8b44aed2e73e718.jpg"
               alt="shalian" />
          <p class="site-author-name" itemprop="name">shalian</p>
          <p class="site-description motion-element" itemprop="description">记录生活点滴</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">49</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">61</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/shalian123" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/3329000660/home?wvr=5" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-pinterest"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.baidu.com/" title="百度" target="_blank">百度</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://harmansecurity.cn/" title="harman" target="_blank">harman</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.codecooler.tech/" title="DoRin" target="_blank">DoRin</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shalian</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"shalian"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  

  

  

</body>
</html>
